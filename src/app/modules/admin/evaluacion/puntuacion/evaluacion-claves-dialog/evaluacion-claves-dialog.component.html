<h2 mat-dialog-title>Claves de evaluaci√≥n</h2>

<mat-dialog-content>
  <div class="space-y-4">
    <div class="text-sm text-gray-600">
      Gestiona las respuestas para las preguntas del rango
      <span class="font-medium text-gray-800">{{ detalle.rangoInicio }}</span>
      al
      <span class="font-medium text-gray-800">{{ detalle.rangoFin }}</span>.
    </div>

    @if (isLoading$ | async) {
      <div class="flex justify-center py-6">
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
      </div>
    } @else {
      <form [formGroup]="form" class="space-y-4">
        <div formArrayName="claves">
          <div class="ag-theme-quartz h-[24rem] w-full">
            <ag-grid-angular
              [rowData]="rowData$ | async"
              [columnDefs]="columnDefs"
              [defaultColDef]="defaultColDef"
              [domLayout]="'normal'"
              [rowHeight]="48"
              [headerHeight]="44"
              [stopEditingWhenCellsLoseFocus]="true"
              [suppressDragLeaveHidesColumns]="true"
              [overlayNoRowsTemplate]="noRowsOverlayTemplate"
              class="w-full"
              (gridReady)="onGridReady($event)"
              (firstDataRendered)="onFirstDataRendered($event)"
            ></ag-grid-angular>
            <ng-container *ngIf="false">
              <!-- Mantiene el renderer de acciones disponible para ag-grid -->
              <app-evaluacion-clave-actions-cell></app-evaluacion-clave-actions-cell>
            </ng-container>
          </div>
        </div>
      </form>
      }
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end" class="gap-2">
  <button mat-stroked-button type="button" (click)="addClave()">
    Agregar registro
  </button>
  <span class="flex-1"></span>
  <button mat-button type="button" (click)="cancel()">Cancelar</button>
  <button
    mat-flat-button
    color="primary"
    type="button"
    (click)="save()"
    [disabled]="isSaving$ | async"
  >
    Guardar
  </button>
</mat-dialog-actions>
