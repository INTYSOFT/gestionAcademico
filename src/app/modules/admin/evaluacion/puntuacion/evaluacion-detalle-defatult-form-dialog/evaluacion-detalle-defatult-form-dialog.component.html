<h2 mat-dialog-title class="text-lg font-semibold text-gray-900">
  {{ isEditMode ? 'Editar detalle por defecto' : 'Nuevo detalle por defecto' }}
</h2>

<div mat-dialog-content class="flex flex-col gap-4">
  @if (isSaving()) {
  <mat-progress-bar mode="indeterminate" color="primary"></mat-progress-bar>
  }

  <form [formGroup]="form" class="flex flex-col gap-4">
    <mat-form-field appearance="outline">
      <mat-label>Tipo de pregunta</mat-label>
      <mat-select formControlName="evaluacionTipoPreguntaId">
        @for (tipo of data.evaluacionTipoPreguntas; track tipo.id) {
        <mat-option [value]="tipo.id">{{ tipo.nombre }}</mat-option>
        }
      </mat-select>
      @if (hasError('evaluacionTipoPreguntaId', 'required')) {
      <mat-error>Selecciona el tipo de pregunta.</mat-error>
      }
    </mat-form-field>

    <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
      <mat-form-field appearance="outline">
        <mat-label>Rango inicio</mat-label>
        <input matInput type="number" formControlName="rangoInicio" min="0" />
        @if (hasError('rangoInicio', 'required')) {
        <mat-error>El rango inicial es obligatorio.</mat-error>
        } @else if (hasError('rangoInicio', 'min')) {
        <mat-error>El rango inicial no puede ser negativo.</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Rango fin</mat-label>
        <input matInput type="number" formControlName="rangoFin" min="0" />
        @if (hasError('rangoFin', 'required')) {
        <mat-error>El rango final es obligatorio.</mat-error>
        } @else if (hasError('rangoFin', 'min')) {
        <mat-error>El rango final no puede ser negativo.</mat-error>
        }
        @if (form.hasError('rangoInvalido') && form.controls.rangoFin.touched) {
        <mat-error>El rango final debe ser mayor o igual que el rango inicial.</mat-error>
        }
      </mat-form-field>
    </div>

    <div class="grid grid-cols-1 gap-4 md:grid-cols-3">
      <mat-form-field appearance="outline">
        <mat-label>Valor buena</mat-label>
        <input matInput type="number" formControlName="valorBuena" step="0.01" />
        @if (hasError('valorBuena', 'required')) {
        <mat-error>Indica el valor para respuestas correctas.</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Valor mala</mat-label>
        <input matInput type="number" formControlName="valorMala" step="0.01" />
        @if (hasError('valorMala', 'required')) {
        <mat-error>Indica el valor para respuestas incorrectas.</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Valor blanca</mat-label>
        <input matInput type="number" formControlName="valorBlanca" step="0.01" />
        @if (hasError('valorBlanca', 'required')) {
        <mat-error>Indica el valor para respuestas en blanco.</mat-error>
        }
      </mat-form-field>
    </div>

    <mat-form-field appearance="outline">
      <mat-label>Observaci√≥n</mat-label>
      <textarea
        matInput
        rows="3"
        formControlName="observacion"
        placeholder="Notas adicionales (opcional)"></textarea>
    </mat-form-field>

    <mat-checkbox formControlName="activo">Detalle activo</mat-checkbox>
  </form>
</div>

<div mat-dialog-actions align="end" class="flex items-center justify-end gap-2">
  <button mat-button type="button" (click)="cancel()" [disabled]="isSaving()">
    Cancelar
  </button>
  <button
    mat-flat-button
    color="primary"
    type="button"
    (click)="save()"
    [disabled]="isSaving()"
  >
    <mat-icon>save</mat-icon>
    Guardar
  </button>
</div>
