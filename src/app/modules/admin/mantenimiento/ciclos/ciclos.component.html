<div class="flex min-w-0 flex-auto flex-col">
    <div class="flex-auto p-6 sm:p-10">
        <section class="ciclos">
            <header class="ciclos__header">
                <mat-form-field
                    appearance="outline"
                    class="ciclos__sede-field">
                    <mat-label>Seleccionar sede</mat-label>
                    <mat-select
                        [formControl]="selectedSedeControl"
                        placeholder="Sede">
                        <mat-option
                            *ngFor="let sede of sedes$ | async; trackBy: trackBySedeId"
                            [value]="sede.id">
                            {{ sede.nombre }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>

                <button
                    mat-raised-button
                    color="primary"
                    type="button"
                    class="ciclos__new-button"
                    (click)="createCiclo()"
                    [disabled]="(isLoadingSedes$ | async) || selectedSedeControl.value == null">
                    <mat-icon>add</mat-icon>
                    Nuevo ciclo
                </button>
            </header>

            <mat-progress-bar
                *ngIf="(isLoadingCiclos$ | async) || (isLoadingSedes$ | async)"
                mode="indeterminate"
                color="primary"></mat-progress-bar>

            <ng-container *ngIf="(sedes$ | async)?.length; else noSedes">
                <ag-grid-angular
                    class="ag-theme-material ciclos__grid"
                    [theme]="'legacy'"
                    [rowData]="ciclos$ | async"
                    [columnDefs]="columnDefs"
                    [defaultColDef]="defaultColDef"
                    [animateRows]="true"
                    [domLayout]="'autoHeight'"
                    (gridReady)="onGridReady($event)"></ag-grid-angular>

                <p
                    class="ciclos__empty"
                    *ngIf="!(isLoadingCiclos$ | async) && !(ciclos$ | async)?.length">
                    No se encontraron ciclos para la sede seleccionada.
                </p>
            </ng-container>

            <ng-template #noSedes>
                <p class="ciclos__empty">
                    No hay sedes registradas. Registra una sede para comenzar a gestionar ciclos.
                </p>
            </ng-template>
        </section>
    </div>
</div>
